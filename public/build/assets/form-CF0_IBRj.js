import{K as V,r as l,j as e,L as q,S as v}from"./app-CQZ61BoK.js";import{z as o,A as D}from"./index-BKgjLX_2.js";import{B as L}from"./button-DVn2xeT-.js";import{C as _,a as A}from"./card-DIbaGwzd.js";import{I as y}from"./input-pnqkoKf5.js";import{R as P,a as C}from"./radio-group-k2964nCx.js";import{S as U,a as $,b as k,c as O,d as z}from"./select-qKR_pDLU.js";import{A as G}from"./app-layout-Brq4PTvv.js";import{s as Z}from"./zod-DeTqYMNs.js";import{u as K}from"./index.esm-BK5FmO0I.js";import{S as W}from"./SyncLoader-DdYVSnic.js";/* empty css            */import"./index-DbyAg2DU.js";import"./createLucideIcon-Dt3Zlyou.js";import"./index-C9Wy1Z_c.js";import"./index-B9z1W7SR.js";import"./x-Cm2QhUop.js";import"./Blueorange-Square-BHcpwURD.js";const H=[{title:"Dashboard",href:"/dashboard"},{title:"Banner",href:"/dashboard/banners"}],J=o.object({title:o.string().min(1,"Title is required"),section:o.string().min(1,"Section is required"),banner:o.any(),category:o.enum(["image","video"],{required_error:"Category is required"})}).superRefine((i,r)=>{if(typeof window<"u"&&window.location.href.includes("/edit")&&!i.banner){console.log("Skipping validation because editing and no new banner uploaded.");return}if(i.category==="video"&&(!i.banner||typeof i.banner=="string"&&i.banner.trim()==="")&&r.addIssue({path:["banner"],code:o.ZodIssueCode.custom,message:"Video file is required"}),i.category==="image"){const t=i.banner instanceof File,m=typeof i.banner=="string"&&i.banner.length>0;!t&&!m&&r.addIssue({path:["banner"],code:o.ZodIssueCode.custom,message:"Image is required"})}}),M=["home","about","works"];function ge({isEdit:i=!1,data:r,sections:a}){var x,j;const{errors:t}=V().props,[m,b]=l.useState(!1),[w,N]=l.useState([]),[g,h]=l.useState(),[d,f]=l.useState(()=>r?r.banner&&typeof r.banner=="string"?`/storage/${r.banner}`:r.image_url&&typeof r.image_url=="string"?`/storage/${r.image_url}`:null:null),{register:I,setValue:p,handleSubmit:F,watch:u,formState:{errors:c}}=K({resolver:Z(J),defaultValues:{title:(r==null?void 0:r.title)||"",section:(r==null?void 0:r.section)||"",banner:(r==null?void 0:r.banner)||"",category:(r==null?void 0:r.category)||"image"}}),B=s=>{p("category",s),p("banner",""),h(null),f(null)},E=s=>{b(!0);const n=new FormData;n.append("title",s.title||""),n.append("section",s.section),n.append("category",s.category),g instanceof File?n.append("banner",g):s.category==="video"&&n.append("banner",s.banner),i&&(r!=null&&r.id)?(n.append("_method","PUT"),v.post(`/dashboard/banners/${r.id}`,n,{forceFormData:!0,onFinish:()=>{b(!1)}})):v.post("/dashboard/banners",n,{forceFormData:!0,onFinish:()=>{b(!1)}})};l.useEffect(()=>{a&&N(a)},[a]);const R=w.map(s=>s.section),T=M.filter(s=>!R.includes(s));return e.jsxs(G,{breadcrumbs:H,children:[e.jsx(q,{title:`Admin Dashboard - ${i?"Edit":"Create"} Banner`}),e.jsxs(D,{children:[e.jsxs("h1",{className:"text-2xl font-semibold",children:[i?"Edit":"Create"," Banner"]}),e.jsx(_,{children:e.jsx(A,{children:e.jsxs("form",{onSubmit:F(E),encType:"multipart/form-data",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Title"}),e.jsx(y,{type:"text",...I("title"),className:"form-control mt-2"}),(c.title||t)&&e.jsx("p",{className:"text-red-500",children:((x=c.title)==null?void 0:x.message)??t.title})]}),!(r!=null&&r.section)&&e.jsxs("div",{children:[e.jsx("label",{children:"Section"}),e.jsxs(U,{onValueChange:s=>p("section",s),name:"section",children:[e.jsx($,{className:"mt-2",children:e.jsx(k,{placeholder:"Select a section"})}),e.jsx(O,{children:T.map((s,n)=>e.jsx(z,{value:s,children:`${s} section`},n))})]}),(c.section||t)&&e.jsx("p",{className:"text-red-500",children:((j=c.section)==null?void 0:j.message)??t.section})]}),e.jsxs(P,{value:u("category"),onValueChange:s=>B(s),className:"mb-4 flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{value:"image",id:"image"}),e.jsx("label",{htmlFor:"image",children:"Image"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{value:"video",id:"video"}),e.jsx("label",{htmlFor:"video",children:"Video"})]})]}),u("category")==="image"&&d&&e.jsxs("div",{children:[e.jsx("h6",{children:"Preview:"}),e.jsx("img",{src:d,alt:"Preview",className:"h-32 w-32 rounded border object-cover"})]}),u("category")==="video"&&d&&e.jsxs("div",{children:[e.jsx("h6",{children:"Preview:"}),e.jsx("video",{src:d,controls:!0,className:"h-32 w-32 rounded border object-cover"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block",children:"Banner"}),e.jsx(y,{type:"file",accept:u("category")==="image"?"image/*":"video/*",onChange:s=>{var S;const n=(S=s.target.files)==null?void 0:S[0];n&&(h(n),p("banner",n),f(URL.createObjectURL(n)))}}),(c.banner||t.banner)&&e.jsx("p",{className:"text-sm text-red-500",children:t.banner})]}),e.jsx(L,{disabled:m,type:"submit",children:m?e.jsx(W,{size:10,color:"#59b4c7"}):"submit"})]})})})]})]})}export{J as bannerScheme,ge as default};
