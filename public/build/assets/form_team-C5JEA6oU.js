import{a as N,r as n,j as e,K as b}from"./app-j1ScH27T.js";import{I as v}from"./input-CIUOX2Xn.js";import{B as S}from"./button-CQ8yYxP_.js";import{C,b as _,a as E}from"./card-DZzINTpL.js";import{a as $}from"./index.esm-C4VZY3i8.js";import{X as T}from"./x-CO3OYAMq.js";function y(m){return m.replace(/\b\w/g,i=>i.toUpperCase())}const D=N.create({baseURL:"http://localhost:8000/api"}),w=({value:m,onChange:i,placeholder:x="Select...",endpoint:l})=>{const[d,u]=n.useState(m),[j,c]=n.useState(!1),[h,r]=n.useState([]),o=n.useRef(null),[s,a]=n.useState(!1),p=n.useCallback(async t=>{a(!0);try{const f=await D.get(l,{params:{search:t}});r(f.data)}catch(f){console.error("Failed to fetch from:",l,f),r([])}finally{a(!1)}},[l]);n.useEffect(()=>{const t=setTimeout(()=>{p(d)},300);return()=>clearTimeout(t)},[d,p]),n.useEffect(()=>{const t=f=>{o.current&&!o.current.contains(f.target)&&c(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const g=t=>{t.key==="Enter"&&(t.preventDefault(),i({id:0,name:d}),c(!1))};return e.jsxs("div",{className:"relative w-full",ref:o,children:[e.jsx(v,{type:"text",value:d,placeholder:x,onFocus:()=>c(!0),onChange:t=>{u(y(t.target.value)),c(!0)},onKeyDown:t=>g(t),className:"w-full rounded-md border px-3 py-2"}),j&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-40 w-full overflow-y-auto rounded border bg-white shadow",children:s?e.jsx("li",{className:"px-3 py-2 text-gray-500",children:"Loading..."}):h.length>0?h.map(t=>e.jsx("li",{className:"cursor-pointer px-3 py-2 hover:bg-gray-100",onMouseDown:()=>{i(t),u(y(t.name)),c(!1)},children:t.name},t.id)):e.jsx("li",{className:"px-3 py-2 text-gray-500",children:"No match"})})]})};function k({form:m}){const{errors:i}=b().props,{setValue:x,watch:l,formState:{errors:d}}=m,{fields:u,append:j,remove:c}=$({control:m.control,name:"teams"}),h=(o,s,a)=>{const p=[...l("teams")];s.forEach((g,t)=>{p[o][g]=a[t]}),x("teams",p)},r=o=>{var s;return((s=d[o])==null?void 0:s.message)||i[o]};return e.jsxs(C,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h6",{className:"text-xl font-semibold",children:"Project Team"}),e.jsx(S,{type:"button",onClick:()=>j({id_name:0,id_role:0,name:"",role:""}),children:"Add Team"})]})}),e.jsx(E,{children:e.jsx("div",{className:"grid grid-cols-1 gap-5",children:u.map((o,s)=>e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(w,{value:l(`teams.${s}.role`),onChange:a=>a&&h(s,["id_role","role"],[a.id,a.name]),endpoint:"/roles",placeholder:"Search role..."}),r(`teams.${s}.role`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.role`)}),r(`teams.${s}.id_role`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.id_role`)})]}),e.jsxs("div",{children:[e.jsx(w,{value:l(`teams.${s}.name`),onChange:a=>a&&h(s,["id_name","name"],[a.id,a.name]),endpoint:"/team-names",placeholder:"Search name..."}),r(`teams.${s}.name`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.name`)}),r(`teams.${s}.id_name`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.id_name`)})]})]}),u.length>1&&e.jsx(T,{onClick:()=>c(s),className:"cursor-pointer text-red-600"})]},o.id))})})]})}const A=Object.freeze(Object.defineProperty({__proto__:null,default:k},Symbol.toStringTag,{value:"Module"}));export{k as T,y as c,A as f};
