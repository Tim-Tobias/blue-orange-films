import{r as n,a as N,j as e,K as v}from"./app-CQZ61BoK.js";import{c as w}from"./capital_letter-XOa2RYLO.js";import{I as C}from"./input-pnqkoKf5.js";import{B as S}from"./button-DVn2xeT-.js";import{C as b,b as E,a as $}from"./card-DIbaGwzd.js";import{a as _}from"./index.esm-BK5FmO0I.js";import{X as T}from"./x-Cm2QhUop.js";/* empty css            */import"./createLucideIcon-Dt3Zlyou.js";const y=({value:p,onChange:f,placeholder:x="Select...",endpoint:l})=>{const[m,i]=n.useState(p),[j,c]=n.useState(!1),[d,r]=n.useState([]),o=n.useRef(null),[s,a]=n.useState(!1),u=n.useCallback(async t=>{a(!0);try{const h=await N.get(l,{params:{search:t}});r(h.data)}catch(h){console.error("Failed to fetch from:",l,h),r([])}finally{a(!1)}},[l]);n.useEffect(()=>{const t=setTimeout(()=>{u(m)},300);return()=>clearTimeout(t)},[m,u]),n.useEffect(()=>{const t=h=>{o.current&&!o.current.contains(h.target)&&c(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const g=t=>{t.key==="Enter"&&(t.preventDefault(),f({id:0,name:m}),c(!1))};return e.jsxs("div",{className:"relative w-full",ref:o,children:[e.jsx(C,{type:"text",value:m,placeholder:x,onFocus:()=>c(!0),onChange:t=>{i(w(t.target.value)),c(!0)},onKeyDown:t=>g(t),className:"w-full rounded-md border px-3 py-2"}),j&&e.jsx("ul",{className:"absolute z-10 mt-1 max-h-40 w-full overflow-y-auto rounded border bg-white shadow",children:s?e.jsx("li",{className:"px-3 py-2 text-gray-500",children:"Loading..."}):d.length>0?d.map(t=>e.jsx("li",{className:"cursor-pointer px-3 py-2 hover:bg-gray-100",onMouseDown:()=>{f(t),i(w(t.name)),c(!1)},children:t.name},t.id)):e.jsx("li",{className:"px-3 py-2 text-gray-500",children:"No match"})})]})};function B({form:p}){const{errors:f}=v().props,{setValue:x,watch:l,formState:{errors:m}}=p,{fields:i,append:j,remove:c}=_({control:p.control,name:"teams"}),d=(o,s,a)=>{const u=[...l("teams")];s.forEach((g,t)=>{u[o][g]=a[t]}),x("teams",u)},r=o=>{var s;return((s=m[o])==null?void 0:s.message)||f[o]};return e.jsxs(b,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h6",{className:"text-xl font-semibold",children:"Project Team"}),e.jsx(S,{type:"button",onClick:()=>j({id_name:0,id_role:0,name:"",role:""}),children:"Add Team"})]})}),e.jsx($,{children:e.jsx("div",{className:"grid grid-cols-1 gap-5",children:i.map((o,s)=>e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(y,{value:l(`teams.${s}.role`),onChange:a=>a&&d(s,["id_role","role"],[a.id,a.name]),endpoint:"/roles",placeholder:"Search role..."}),r(`teams.${s}.role`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.role`)}),r(`teams.${s}.id_role`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.id_role`)})]}),e.jsxs("div",{children:[e.jsx(y,{value:l(`teams.${s}.name`),onChange:a=>a&&d(s,["id_name","name"],[a.id,a.name]),endpoint:"/team-names",placeholder:"Search name..."}),r(`teams.${s}.name`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.name`)}),r(`teams.${s}.id_name`)&&e.jsx("p",{className:"text-sm text-red-500",children:r(`teams.${s}.id_name`)})]})]}),i.length>1&&e.jsx(T,{onClick:()=>c(s),className:"cursor-pointer text-red-600"})]},o.id))})})]})}export{B as default};
